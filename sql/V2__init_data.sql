-- ========================================
-- 云上重走长征路 - 初始数据脚本
-- Version: V2
-- ========================================

USE `changzheng_db`;

-- ========================================
-- 1. 初始化系统配置
-- ========================================
INSERT INTO `t_system_config` (`config_key`, `config_value`, `config_type`, `config_group`, `description`, `is_public`) VALUES
('STEP_TO_KM_RATE', '2000', 'INT', 'SPORT', '步数换算比例(步/公里)', 1),
('DAILY_STEP_LIMIT', '30000', 'INT', 'SPORT', '每日步数上限', 1),
('ANOMALY_STEP_THRESHOLD', '50000', 'INT', 'SPORT', '异常步数阈值(超过标记异常)', 0),
('TOTAL_MARCH_DISTANCE', '25000', 'DECIMAL', 'SPORT', '长征总里程(公里)', 1),
('VALID_YEARS', '3', 'INT', 'SPORT', '有效累计年限', 1),
('RANK_PAGE_SIZE', '50', 'INT', 'RANK', '排行榜每页数量', 1),
('RANK_REFRESH_CRON', '0 15 0 * * ?', 'STRING', 'RANK', '排行榜刷新cron表达式', 0),
('DAILY_SETTLE_CRON', '0 10 0 * * ?', 'STRING', 'SETTLE', '每日结算cron表达式', 0);

-- ========================================
-- 2. 初始化长征路线节点
-- ========================================
INSERT INTO `t_route_node` (`node_code`, `node_name`, `mileage_threshold`, `sort_order`, `longitude`, `latitude`, `description`, `status`) VALUES
('RUIJIN', '瑞金', 0, 1, 116.0271, 25.8854, '中央红军长征出发地，中华苏维埃共和国临时中央政府所在地', 1),
('YUDU', '于都', 100, 2, 115.4153, 25.9521, '中央红军长征集结出发地', 1),
('XINFENG', '信丰', 300, 3, 114.9229, 25.3861, '红军突破第一道封锁线', 1),
('DAYU', '大余', 500, 4, 114.3622, 25.4014, '红军突破第二道封锁线', 1),
('CHENZHOU', '郴州', 800, 5, 113.0147, 25.7703, '红军突破第三道封锁线', 1),
('XIANGJIANG', '湘江', 1200, 6, 110.2907, 25.2744, '湘江战役，红军损失惨重', 1),
('ZUNYI', '遵义', 2000, 7, 106.9273, 27.7254, '遵义会议，历史转折点', 1),
('MAOTAI', '茅台', 2500, 8, 106.3997, 27.8544, '四渡赤水第一渡', 1),
('CHISHUI', '赤水', 3500, 9, 105.6975, 28.5903, '四渡赤水，红军化被动为主动', 1),
('JIAOPINGDU', '皎平渡', 5000, 10, 102.1533, 26.0997, '巧渡金沙江', 1),
('LUDING', '泸定桥', 6500, 11, 102.2346, 29.9167, '飞夺泸定桥，22勇士强渡', 1),
('JIAJIN', '夹金山', 8000, 12, 102.8661, 31.0039, '翻越第一座大雪山', 1),
('LIANGHEKOU', '两河口', 9000, 13, 102.6036, 31.4014, '两河口会议，确定北上战略', 1),
('MAOGAI', '毛尔盖', 10000, 14, 103.2522, 32.6436, '红军过草地起点', 1),
('CAODI', '松潘草地', 12000, 15, 103.6042, 32.6551, '穿越死亡草地', 1),
('LAZIKOU', '腊子口', 15000, 16, 103.8514, 34.1197, '突破腊子口天险', 1),
('HADAPU', '哈达铺', 17000, 17, 104.0936, 34.1542, '在此得知陕北红军消息', 1),
('LIUPANSHAN', '六盘山', 20000, 18, 106.1833, 35.6833, '翻越最后一座大山', 1),
('WUQI', '吴起镇', 22000, 19, 107.3883, 36.9275, '中央红军长征结束', 1),
('HUINING', '会宁会师', 25000, 20, 105.0961, 35.6928, '红军三大主力会师，长征胜利结束', 1);

-- ========================================
-- 3. 初始化成就配置
-- ========================================
INSERT INTO `t_achievement` (`achievement_code`, `achievement_name`, `description`, `achievement_type`, `condition_type`, `condition_value`, `points`, `sort_order`, `status`) VALUES
('FIRST_STEP', '迈出第一步', '累计行走1公里', 'MILEAGE', 'GTE', 1, 10, 1, 1),
('HUNDRED_KM', '初入长征', '累计行走100公里', 'MILEAGE', 'GTE', 100, 50, 2, 1),
('THOUSAND_KM', '千里之行', '累计行走1000公里', 'MILEAGE', 'GTE', 1000, 100, 3, 1),
('FIVE_THOUSAND_KM', '万水千山', '累计行走5000公里', 'MILEAGE', 'GTE', 5000, 200, 4, 1),
('TEN_THOUSAND_KM', '铁脚板', '累计行走10000公里', 'MILEAGE', 'GTE', 10000, 300, 5, 1),
('HALF_MARCH', '半程先锋', '完成长征50%里程(12500公里)', 'MILEAGE', 'GTE', 12500, 500, 6, 1),
('FULL_MARCH', '长征完成者', '完成完整长征(25000公里)', 'MILEAGE', 'GTE', 25000, 1000, 7, 1),
('STREAK_7', '坚持之星', '连续运动7天', 'CONTINUOUS', 'GTE', 7, 70, 10, 1),
('STREAK_30', '铁人意志', '连续运动30天', 'CONTINUOUS', 'GTE', 30, 300, 11, 1),
('STREAK_100', '百日征程', '连续运动100天', 'CONTINUOUS', 'GTE', 100, 1000, 12, 1),
('NODE_FIRST', '节点探索者', '解锁第一个节点', 'NODE', 'GTE', 1, 20, 20, 1),
('NODE_HALF', '历史学者', '解锁一半节点', 'NODE', 'GTE', 10, 200, 21, 1),
('NODE_ALL', '长征专家', '解锁全部节点', 'NODE', 'GTE', 20, 500, 22, 1);

-- ========================================
-- 4. 初始化节点内容(示例)
-- ========================================
INSERT INTO `t_node_content` (`node_id`, `version`, `title`, `video_url`, `video_cover_url`, `video_duration`, `content_text`, `content_summary`, `is_current`, `publish_time`) VALUES
(1, 1, '瑞金：共和国摇篮', '/videos/ruijin.mp4', '/images/ruijin_cover.jpg', 300, 
'<p>瑞金是中华苏维埃共和国临时中央政府所在地，被誉为"共和国摇篮"。</p><p>1931年11月7日，中华苏维埃第一次全国代表大会在这里召开，宣告中华苏维埃共和国成立。</p><p>1934年10月，中央红军从这里出发，开始了伟大的二万五千里长征。</p>', 
'中央红军长征出发地', 1, NOW()),
(7, 1, '遵义会议：伟大转折', '/videos/zunyi.mp4', '/images/zunyi_cover.jpg', 480,
'<p>1935年1月15日至17日，中共中央政治局在贵州遵义召开扩大会议。</p><p>会议批评了博古、李德的军事路线错误，确立了毛泽东在党中央和红军中的领导地位。</p><p>遵义会议是中国共产党历史上生死攸关的转折点，挽救了党，挽救了红军，挽救了中国革命。</p>',
'中国革命历史转折点', 1, NOW()),
(11, 1, '飞夺泸定桥：勇士壮举', '/videos/luding.mp4', '/images/luding_cover.jpg', 420,
'<p>1935年5月29日，红军到达泸定桥西岸。</p><p>22名突击队员冒着敌人密集的炮火，攀着13根铁索向东岸冲去。</p><p>经过两小时激战，红军夺取了泸定桥，为大部队渡过大渡河打开了通道。</p><p>飞夺泸定桥是红军长征中最惊心动魄的战斗之一，充分体现了红军将士不怕牺牲、勇往直前的革命精神。</p>',
'22勇士强渡大渡河', 1, NOW()),
(20, 1, '会宁会师：长征胜利', '/videos/huining.mp4', '/images/huining_cover.jpg', 360,
'<p>1936年10月，红军三大主力在甘肃会宁胜利会师。</p><p>会宁会师标志着红军长征的胜利结束，是中国革命史上的重大事件。</p><p>长征是人类历史上的伟大壮举，红军将士以坚定的理想信念和钢铁般的意志，战胜了无数艰难险阻，创造了人间奇迹。</p>',
'红军三大主力会师', 1, NOW());

-- ========================================
-- 5. 初始化管理员账号
-- ========================================
-- 密码: admin123 (BCrypt加密)
INSERT INTO `t_admin` (`username`, `password`, `real_name`, `role`, `status`) VALUES
('admin', '$2a$10$EixZaYVK1fsbw1ZfbX3OXePaWxn96p36WQoeG6Lruj3vjPGga31lW', '系统管理员', 'SUPER_ADMIN', 1);

-- ========================================
-- 6. 初始化测试学生数据
-- ========================================
INSERT INTO `t_student_info` (`student_no`, `name`, `gender`, `major`, `class_name`, `grade`, `enroll_year`, `phone`, `is_bound`, `status`) VALUES
('2024031294', '李荣为', '男', '软件技术', '软件24349', '2024级', 2024, NULL, 0, 1),
('20230001', '张三', '男', '软件技术', '软件2301', '2023级', 2023, '13800000001', 0, 1),
('20230002', '李四', '女', '软件技术', '软件2301', '2023级', 2023, '13800000002', 0, 1),
('20230003', '王五', '男', '计算机应用技术', '计应2301', '2023级', 2023, '13800000003', 0, 1),
('20230004', '赵六', '女', '大数据技术', '大数据2301', '2023级', 2023, '13800000004', 0, 1),
('20230005', '钱七', '男', '物联网应用技术', '物联网2301', '2023级', 2023, '13800000005', 0, 1);
