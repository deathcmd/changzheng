const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/node-CBtfmk6D.js","assets/index-aAsznUlZ.js","assets/element-plus-DOarM9kH.js","assets/index-CqmoLc5R.css"])))=>i.map(i=>d[i]);
import{u as j,_ as h}from"./index-aAsznUlZ.js";import{_ as q}from"./_plugin-vue_export-helper-DRcqrMy4.js";/* empty css                        *//* empty css                   *//* empty css                 *//* empty css                        *//* empty css                *//* empty css                  */import{r as f,a as F,N as z,j as Y,C as K,F as t,G as a,af as X,l as T,k as Z,ag as Q,ah as W,ai as ee,L as p,X as te,K as le,aj as oe,D as w,V as ae,ad as de,M as se,H as ne,I as ie,ak as re,al as ue,am as me,y as pe,E as g}from"./element-plus-DOarM9kH.js";const ce={class:"node-list"},fe={class:"card-header"},I=!0,ge={__name:"list",setup(_e){const O=[{id:1,nodeCode:"RUIJIN",nodeName:"瑞金",mileageThreshold:0,sortOrder:1,description:"长征出发地",status:1,longitude:116.0279,latitude:25.8847},{id:2,nodeCode:"YUDU",nodeName:"于都",mileageThreshold:60,sortOrder:2,description:"红军集结出发地",status:1,longitude:115.4153,latitude:25.9522},{id:3,nodeCode:"XIANGJIANG",nodeName:"湘江",mileageThreshold:400,sortOrder:3,description:"湘江战役",status:1,longitude:111.0067,latitude:25.2744},{id:4,nodeCode:"ZUNYI",nodeName:"遵义",mileageThreshold:1200,sortOrder:4,description:"遵义会议",status:1,longitude:106.9271,latitude:27.7256},{id:5,nodeCode:"CHISHUI",nodeName:"赤水河",mileageThreshold:1500,sortOrder:5,description:"四渡赤水",status:1,longitude:105.7,latitude:28.0167},{id:6,nodeCode:"JINSHAJIANG",nodeName:"金沙江",mileageThreshold:2500,sortOrder:6,description:"巧渡金沙江",status:1,longitude:103.2667,latitude:26.6167},{id:7,nodeCode:"LUDING",nodeName:"泸定桥",mileageThreshold:3500,sortOrder:7,description:"飞夺泸定桥",status:1,longitude:102.2333,latitude:29.9167},{id:8,nodeCode:"JIAJINSHAN",nodeName:"夹金山",mileageThreshold:4e3,sortOrder:8,description:"翠越夹金山",status:1,longitude:102.8167,latitude:30.8667},{id:9,nodeCode:"CAODI",nodeName:"草地",mileageThreshold:5e3,sortOrder:9,description:"过草地",status:1,longitude:102.9667,latitude:33.4333},{id:10,nodeCode:"HUINING",nodeName:"会宁",mileageThreshold:25e3,sortOrder:10,description:"三大主力会师",status:1,longitude:105.0536,latitude:35.6928}],U=j(),N=f(!1),C=f(!1),u=f(!1),_=f(!1),i=f([]),y=f(null),l=F({id:null,nodeCode:"",nodeName:"",mileageThreshold:0,sortOrder:1,longitude:null,latitude:null,description:"",status:1}),k={nodeCode:[{required:!0,message:"请输入节点编码",trigger:"blur"}],nodeName:[{required:!0,message:"请输入节点名称",trigger:"blur"}],mileageThreshold:[{required:!0,message:"请输入里程阈值",trigger:"blur"}],sortOrder:[{required:!0,message:"请输入排序序号",trigger:"blur"}]};z(()=>{V()});async function V(){N.value=!0;try{if(I){await new Promise(s=>setTimeout(s,300)),i.value=O;return}const{getNodeList:d}=await h(async()=>{const{getNodeList:s}=await import("./node-CBtfmk6D.js");return{getNodeList:s}},__vite__mapDeps([0,1,2,3])),e=await d();i.value=e.data.list||e.data}finally{N.value=!1}}function x(){_.value=!1,R(),u.value=!0}function D(d){_.value=!0,Object.assign(l,d),u.value=!0}function L(d){U.push(`/nodes/${d.id}/content`)}async function A(d){try{if(await pe.confirm(`确认删除节点“${d.nodeName}”?`,"提示",{type:"warning"}),I){i.value=i.value.filter(s=>s.id!==d.id),g.success("删除成功");return}const{deleteNode:e}=await h(async()=>{const{deleteNode:s}=await import("./node-CBtfmk6D.js");return{deleteNode:s}},__vite__mapDeps([0,1,2,3]));await e(d.id),g.success("删除成功"),V()}catch(e){e!=="cancel"&&console.error("删除失败:",e)}}async function P(){var d;try{if(await((d=y.value)==null?void 0:d.validate()),C.value=!0,I){if(_.value){const c=i.value.findIndex(n=>n.id===l.id);c>-1&&(i.value[c]={...l}),g.success("更新成功")}else i.value.push({...l,id:Date.now()}),g.success("创建成功");u.value=!1;return}const{createNode:e,updateNode:s}=await h(async()=>{const{createNode:c,updateNode:n}=await import("./node-CBtfmk6D.js");return{createNode:c,updateNode:n}},__vite__mapDeps([0,1,2,3]));_.value?(await s(l.id,l),g.success("更新成功")):(await e(l),g.success("创建成功")),u.value=!1,V()}finally{C.value=!1}}function R(){Object.assign(l,{id:null,nodeCode:"",nodeName:"",mileageThreshold:0,sortOrder:1,longitude:null,latitude:null,description:"",status:1})}return(d,e)=>{const s=Y("Plus"),c=ae,n=le,m=W,S=ee,B=Q,G=de,b=ie,r=ne,v=re,H=ue,J=se,$=me,M=oe;return T(),K("div",ce,[t(G,{shadow:"hover"},{header:a(()=>[w("div",fe,[e[11]||(e[11]=w("span",null,"节点管理",-1)),t(n,{type:"primary",onClick:x},{default:a(()=>[t(c,null,{default:a(()=>[t(s)]),_:1}),e[10]||(e[10]=p(" 新增节点 ",-1))]),_:1})])]),default:a(()=>[X((T(),Z(B,{data:i.value,stripe:""},{default:a(()=>[t(m,{prop:"sortOrder",label:"序号",width:"80"}),t(m,{prop:"nodeCode",label:"编码",width:"120"}),t(m,{prop:"nodeName",label:"名称",width:"120"}),t(m,{prop:"mileageThreshold",label:"里程阈值(km)",width:"130"}),t(m,{prop:"description",label:"描述","show-overflow-tooltip":""}),t(m,{label:"状态",width:"100"},{default:a(({row:o})=>[t(S,{type:o.status===1?"success":"info"},{default:a(()=>[p(te(o.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(m,{label:"操作",width:"220",fixed:"right"},{default:a(({row:o})=>[t(n,{size:"small",onClick:E=>D(o)},{default:a(()=>[...e[12]||(e[12]=[p("编辑",-1)])]),_:1},8,["onClick"]),t(n,{size:"small",type:"primary",onClick:E=>L(o)},{default:a(()=>[...e[13]||(e[13]=[p("内容",-1)])]),_:1},8,["onClick"]),t(n,{size:"small",type:"danger",onClick:E=>A(o)},{default:a(()=>[...e[14]||(e[14]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[M,N.value]])]),_:1}),t($,{modelValue:u.value,"onUpdate:modelValue":e[9]||(e[9]=o=>u.value=o),title:_.value?"编辑节点":"新增节点",width:"600px"},{footer:a(()=>[t(n,{onClick:e[8]||(e[8]=o=>u.value=!1)},{default:a(()=>[...e[16]||(e[16]=[p("取消",-1)])]),_:1}),t(n,{type:"primary",loading:C.value,onClick:P},{default:a(()=>[...e[17]||(e[17]=[p("确定",-1)])]),_:1},8,["loading"])]),default:a(()=>[t(J,{ref_key:"formRef",ref:y,model:l,rules:k,"label-width":"100px"},{default:a(()=>[t(r,{label:"节点编码",prop:"nodeCode"},{default:a(()=>[t(b,{modelValue:l.nodeCode,"onUpdate:modelValue":e[0]||(e[0]=o=>l.nodeCode=o),placeholder:"如: ZUNYI"},null,8,["modelValue"])]),_:1}),t(r,{label:"节点名称",prop:"nodeName"},{default:a(()=>[t(b,{modelValue:l.nodeName,"onUpdate:modelValue":e[1]||(e[1]=o=>l.nodeName=o),placeholder:"如: 遵义"},null,8,["modelValue"])]),_:1}),t(r,{label:"里程阈值",prop:"mileageThreshold"},{default:a(()=>[t(v,{modelValue:l.mileageThreshold,"onUpdate:modelValue":e[2]||(e[2]=o=>l.mileageThreshold=o),min:0,max:3e4},null,8,["modelValue"]),e[15]||(e[15]=w("span",{class:"unit"},"公里",-1))]),_:1}),t(r,{label:"排序序号",prop:"sortOrder"},{default:a(()=>[t(v,{modelValue:l.sortOrder,"onUpdate:modelValue":e[3]||(e[3]=o=>l.sortOrder=o),min:1,max:100},null,8,["modelValue"])]),_:1}),t(r,{label:"经度"},{default:a(()=>[t(v,{modelValue:l.longitude,"onUpdate:modelValue":e[4]||(e[4]=o=>l.longitude=o),precision:6},null,8,["modelValue"])]),_:1}),t(r,{label:"纬度"},{default:a(()=>[t(v,{modelValue:l.latitude,"onUpdate:modelValue":e[5]||(e[5]=o=>l.latitude=o),precision:6},null,8,["modelValue"])]),_:1}),t(r,{label:"描述"},{default:a(()=>[t(b,{modelValue:l.description,"onUpdate:modelValue":e[6]||(e[6]=o=>l.description=o),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),t(r,{label:"状态"},{default:a(()=>[t(H,{modelValue:l.status,"onUpdate:modelValue":e[7]||(e[7]=o=>l.status=o),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Ee=q(ge,[["__scopeId","data-v-a585f086"]]);export{Ee as default};
