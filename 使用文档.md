# 云上重走长征路 - 使用手册

> 四川工商职业技术学院 · 智能制造与信息工程学院

「云上重走长征路」是一款结合微信运动与红色教育的创新应用。通过虚拟长征路程，让用户在运动中学习历史，弘扬长征精神。

---

## 一、 项目简介

本系统通过同步微信运动步数，按比例映射到红军长征的 25,000 里征程中。
- **里程碑解锁**：用户达到特定里程后，可解锁历史节点，学习相关的图文、视音频教学内容。
- **多维排行榜**：支持个人、班级、年级以及全校的实时排名对比。
- **学生认证**：集成校内学生库，实现实名认证与精准数据归属。

---

## 二、 快速开始 (学生端)

1. **登录授权**：打开小程序，完成微信一键登录及微信运动权限授权。
2. **学生认证**：在「我的」页面进行认证，输入学号及真实姓名进行匹配。
3. **步数同步**：首页下拉刷新或点击「同步步数」，系统将获取您今日的微信步数。
4. **探索与学习**：在「长征地图」中查看当前位置，点击已解锁节点进入学习页面。

---

## 三、 技术架构

### 3.1 后端技术栈 (Spring Cloud Alibaba)
| 技术 | 版本 | 说明 |
|------|------|------|
| JDK | 17 | 核心运行环境 |
| Spring Boot | 3.2.x | 微服务基础框架 |
| Nacos | 2.3.x | 注册中心与配置中心 |
| MyBatis Plus | 3.5.x | 数据库 ORM 工具 |
| Sa-Token | 1.37.x | 认证与鉴权框架 |
| MySQL | 8.0 | 关系型数据库 |
| Redis | 7.x | 分布式缓存 |

### 3.2 前端技术栈
- **管理后台**：Vue 3 + Vite + Element Plus + ECharts
- **小程序**：微信原生框架 + Tailwind-like CSS 样式库

---

## 四、 项目目录结构

```text
changzheng/
├── changzheng-gateway/       # 统一 API 网关
├── changzheng-auth/          # 认证与用户服务 (微信/认证)
├── changzheng-sport/         # 运动服务 (步数换算/里程)
├── changzheng-content/       # 内容服务 (地图节点/教学内容)
├── changzheng-rank/          # 排行榜服务 (Redis 高效排名)
├── changzheng-admin/         # 后台管理业务接口
├── changzheng-admin-web/     # Vue3 管理后台前端
├── changzheng-miniprogram/   # 微信小程序源码
└── sql/                      # 数据库初始化脚本
```

---

## 五、 开发与单机运行

1. **中间件准备**：本地启动 MySQL (8.0) 和 Redis。
2. **Nacos 配置**：启动 Nacos 并导入对应的配置集（或使用默认文件）。
3. **后端启动**：
   - 先编译 `common` 模块：`mvn install -pl changzheng-common`
   - 依次启动各子模块的 `Application` 类。
4. **前端启动**：
   - 后台：`cd changzheng-admin-web && npm install && npm run dev`
   - 小程序：微信开发者工具导入 `changzheng-miniprogram` 目录。

---

## 六、 管理后台使用指南

- **数据看板**：实时查看全校总里程、今日活跃人数及学生认证覆盖率。
- **学生管理**：支持 Excel 模版批量导入导出，管理学生学籍与认证状态。
- **内容配置**：维护长征路上的历史节点、学习资源及对应的解锁里程。
- **权限管理**：配置不同权限的管理账号。

---

## 七、 核心逻辑说明

### 7.1 步数换算规则
- **比例**：每一公里对应一定步数（默认 2000 步 = 1 公里）。
- **上限**：单日最大计入步数为 30,000 步。

### 7.2 Mock 开发模式
在 `miniprogram/config/index.js` 中：
- `useMock: true`：此时小程序将使用本地模拟数据，适合无后端环境下的 UI 调试。

---

## 八、 常见问题 (FAQ)

**Q: 认证时提示“学号不存在”？**
A: 请确认管理员是否已在后台「学生管理」中导入了您的学籍信息。

**Q: 微信运动步数不准？**
A: 小程序获取的是微信运动的授权数据。若数据延迟，请在微信中打开“微信运动”界面刷新后再尝试。

**Q: 如何更换头像和昵称？**
A: 进入「我的」->「编辑资料」，系统将再次通过微信获取您的最新公开信息。

---

© 2025 四川工商职业技术学院 · 智造信息学院
